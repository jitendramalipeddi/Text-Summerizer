
-----------------------MLE Training-------------------------------

Training mle: yes, Training rl: no, mle weight: 1.00, rl weight: 0.00
intra_encoder: True intra_decoder: True
iter: 10 mle_loss: 6.096 reward: 0.0000
iter: 20 mle_loss: 5.966 reward: 0.0000
iter: 30 mle_loss: 6.159 reward: 0.0000
iter: 40 mle_loss: 5.679 reward: 0.0000
iter: 50 mle_loss: 5.007 reward: 0.0000
iter: 60 mle_loss: 5.090 reward: 0.0000
iter: 70 mle_loss: 5.502 reward: 0.0000
iter: 80 mle_loss: 4.953 reward: 0.0000
iter: 90 mle_loss: 5.002 reward: 0.0000
iter: 100 mle_loss: 4.692 reward: 0.0000
iter: 110 mle_loss: 5.385 reward: 0.0000
iter: 120 mle_loss: 5.303 reward: 0.0000
iter: 130 mle_loss: 4.571 reward: 0.0000
iter: 140 mle_loss: 4.720 reward: 0.0000
iter: 150 mle_loss: 4.405 reward: 0.0000
iter: 160 mle_loss: 5.321 reward: 0.0000
iter: 170 mle_loss: 4.416 reward: 0.0000
iter: 180 mle_loss: 4.264 reward: 0.0000
iter: 190 mle_loss: 4.877 reward: 0.0000
iter: 200 mle_loss: 4.448 reward: 0.0000
iter: 210 mle_loss: 5.074 reward: 0.0000
iter: 220 mle_loss: 4.514 reward: 0.0000
iter: 230 mle_loss: 4.744 reward: 0.0000
iter: 240 mle_loss: 4.524 reward: 0.0000
iter: 250 mle_loss: 4.152 reward: 0.0000
iter: 260 mle_loss: 4.397 reward: 0.0000
iter: 270 mle_loss: 4.775 reward: 0.0000
iter: 280 mle_loss: 4.599 reward: 0.0000
iter: 290 mle_loss: 3.739 reward: 0.0000
iter: 300 mle_loss: 4.016 reward: 0.0000
iter: 310 mle_loss: 4.158 reward: 0.0000
iter: 320 mle_loss: 4.142 reward: 0.0000
iter: 330 mle_loss: 4.917 reward: 0.0000
iter: 340 mle_loss: 3.511 reward: 0.0000
iter: 350 mle_loss: 3.463 reward: 0.0000
iter: 360 mle_loss: 4.310 reward: 0.0000
iter: 370 mle_loss: 3.559 reward: 0.0000
iter: 380 mle_loss: 4.114 reward: 0.0000
iter: 390 mle_loss: 4.214 reward: 0.0000
iter: 400 mle_loss: 3.402 reward: 0.0000
iter: 410 mle_loss: 3.657 reward: 0.0000
iter: 420 mle_loss: 3.970 reward: 0.0000
iter: 430 mle_loss: 4.090 reward: 0.0000
iter: 440 mle_loss: 3.711 reward: 0.0000
iter: 450 mle_loss: 3.777 reward: 0.0000
iter: 460 mle_loss: 3.211 reward: 0.0000
iter: 470 mle_loss: 3.391 reward: 0.0000
iter: 480 mle_loss: 2.891 reward: 0.0000
iter: 490 mle_loss: 3.634 reward: 0.0000
iter: 500 mle_loss: 3.202 reward: 0.0000
iter: 510 mle_loss: 4.133 reward: 0.0000
iter: 520 mle_loss: 2.833 reward: 0.0000
iter: 530 mle_loss: 3.865 reward: 0.0000
iter: 540 mle_loss: 3.059 reward: 0.0000
iter: 550 mle_loss: 2.823 reward: 0.0000
iter: 560 mle_loss: 3.031 reward: 0.0000
iter: 570 mle_loss: 3.796 reward: 0.0000
iter: 580 mle_loss: 2.756 reward: 0.0000
iter: 590 mle_loss: 2.535 reward: 0.0000
iter: 600 mle_loss: 3.250 reward: 0.0000
iter: 610 mle_loss: 3.119 reward: 0.0000
iter: 620 mle_loss: 2.987 reward: 0.0000
iter: 630 mle_loss: 2.225 reward: 0.0000
iter: 640 mle_loss: 2.967 reward: 0.0000
iter: 650 mle_loss: 3.177 reward: 0.0000
iter: 660 mle_loss: 3.173 reward: 0.0000
iter: 670 mle_loss: 1.853 reward: 0.0000
iter: 680 mle_loss: 2.573 reward: 0.0000
iter: 690 mle_loss: 2.437 reward: 0.0000
iter: 700 mle_loss: 2.171 reward: 0.0000
iter: 710 mle_loss: 2.531 reward: 0.0000
iter: 720 mle_loss: 2.995 reward: 0.0000
iter: 730 mle_loss: 2.903 reward: 0.0000
iter: 740 mle_loss: 1.994 reward: 0.0000
iter: 750 mle_loss: 2.733 reward: 0.0000
iter: 760 mle_loss: 1.958 reward: 0.0000
iter: 770 mle_loss: 2.350 reward: 0.0000
iter: 780 mle_loss: 2.750 reward: 0.0000
iter: 790 mle_loss: 1.864 reward: 0.0000
iter: 800 mle_loss: 2.216 reward: 0.0000
iter: 810 mle_loss: 2.693 reward: 0.0000
iter: 820 mle_loss: 1.854 reward: 0.0000
iter: 830 mle_loss: 1.514 reward: 0.0000
iter: 840 mle_loss: 2.396 reward: 0.0000
iter: 850 mle_loss: 1.976 reward: 0.0000
iter: 860 mle_loss: 2.025 reward: 0.0000
iter: 870 mle_loss: 1.412 reward: 0.0000
iter: 880 mle_loss: 2.350 reward: 0.0000
iter: 890 mle_loss: 2.441 reward: 0.0000
iter: 900 mle_loss: 2.391 reward: 0.0000
iter: 910 mle_loss: 1.109 reward: 0.0000
iter: 920 mle_loss: 1.864 reward: 0.0000
iter: 930 mle_loss: 2.332 reward: 0.0000
iter: 940 mle_loss: 1.397 reward: 0.0000
iter: 950 mle_loss: 1.889 reward: 0.0000
iter: 960 mle_loss: 1.921 reward: 0.0000
iter: 970 mle_loss: 1.318 reward: 0.0000
iter: 980 mle_loss: 1.248 reward: 0.0000
iter: 990 mle_loss: 1.571 reward: 0.0000
iter: 1000 mle_loss: 2.029 reward: 0.0000
iter: 1010 mle_loss: 1.780 reward: 0.0000
iter: 1020 mle_loss: 1.048 reward: 0.0000
iter: 1030 mle_loss: 1.570 reward: 0.0000
iter: 1040 mle_loss: 1.435 reward: 0.0000
iter: 1050 mle_loss: 1.943 reward: 0.0000
iter: 1060 mle_loss: 1.415 reward: 0.0000
iter: 1070 mle_loss: 0.882 reward: 0.0000
iter: 1080 mle_loss: 1.450 reward: 0.0000
iter: 1090 mle_loss: 1.792 reward: 0.0000
iter: 1100 mle_loss: 1.566 reward: 0.0000
iter: 1110 mle_loss: 1.859 reward: 0.0000
iter: 1120 mle_loss: 1.053 reward: 0.0000
iter: 1130 mle_loss: 1.070 reward: 0.0000
iter: 1140 mle_loss: 0.911 reward: 0.0000
iter: 1150 mle_loss: 1.069 reward: 0.0000
iter: 1160 mle_loss: 0.991 reward: 0.0000
iter: 1180 mle_loss: 1.717 reward: 0.0000
iter: 1190 mle_loss: 0.983 reward: 0.0000
iter: 1200 mle_loss: 0.859 reward: 0.0000
iter: 1210 mle_loss: 1.725 reward: 0.0000
iter: 1220 mle_loss: 0.999 reward: 0.0000
iter: 1230 mle_loss: 1.079 reward: 0.0000
iter: 1240 mle_loss: 1.347 reward: 0.0000
iter: 1250 mle_loss: 1.195 reward: 0.0000
iter: 1260 mle_loss: 0.718 reward: 0.0000
iter: 1270 mle_loss: 1.110 reward: 0.0000
iter: 1280 mle_loss: 1.268 reward: 0.0000
iter: 1290 mle_loss: 1.262 reward: 0.0000
iter: 1300 mle_loss: 0.604 reward: 0.0000
iter: 1310 mle_loss: 1.042 reward: 0.0000
iter: 1320 mle_loss: 0.964 reward: 0.0000
iter: 1330 mle_loss: 1.099 reward: 0.0000
iter: 1340 mle_loss: 0.937 reward: 0.0000
iter: 1350 mle_loss: 0.820 reward: 0.0000
iter: 1360 mle_loss: 0.795 reward: 0.0000
iter: 1370 mle_loss: 0.942 reward: 0.0000
iter: 1380 mle_loss: 1.476 reward: 0.0000
iter: 1390 mle_loss: 0.846 reward: 0.0000
iter: 1400 mle_loss: 0.594 reward: 0.0000
iter: 1410 mle_loss: 1.201 reward: 0.0000
iter: 1420 mle_loss: 0.754 reward: 0.0000
iter: 1430 mle_loss: 0.673 reward: 0.0000
iter: 1440 mle_loss: 0.751 reward: 0.0000
iter: 1450 mle_loss: 0.677 reward: 0.0000
iter: 1460 mle_loss: 0.494 reward: 0.0000
iter: 1470 mle_loss: 0.957 reward: 0.0000
iter: 1480 mle_loss: 0.528 reward: 0.0000
iter: 1490 mle_loss: 0.657 reward: 0.0000
iter: 1500 mle_loss: 0.745 reward: 0.0000
iter: 1510 mle_loss: 0.736 reward: 0.0000
iter: 1520 mle_loss: 0.909 reward: 0.0000
iter: 1530 mle_loss: 0.632 reward: 0.0000
iter: 1540 mle_loss: 0.771 reward: 0.0000
iter: 1550 mle_loss: 0.491 reward: 0.0000
iter: 1560 mle_loss: 0.649 reward: 0.0000
iter: 1570 mle_loss: 0.761 reward: 0.0000
iter: 1580 mle_loss: 0.281 reward: 0.0000
iter: 1590 mle_loss: 0.513 reward: 0.0000
iter: 1600 mle_loss: 0.895 reward: 0.0000
iter: 1610 mle_loss: 0.821 reward: 0.0000
iter: 1620 mle_loss: 0.642 reward: 0.0000
iter: 1630 mle_loss: 0.543 reward: 0.0000
iter: 1640 mle_loss: 0.410 reward: 0.0000
iter: 1650 mle_loss: 0.719 reward: 0.0000
iter: 1660 mle_loss: 0.679 reward: 0.0000
iter: 1670 mle_loss: 0.643 reward: 0.0000
iter: 1680 mle_loss: 0.376 reward: 0.0000
iter: 1690 mle_loss: 0.657 reward: 0.0000
iter: 1700 mle_loss: 0.629 reward: 0.0000
iter: 1710 mle_loss: 0.664 reward: 0.0000
iter: 1720 mle_loss: 0.313 reward: 0.0000
iter: 1730 mle_loss: 0.505 reward: 0.0000
iter: 1740 mle_loss: 0.504 reward: 0.0000
iter: 1750 mle_loss: 0.627 reward: 0.0000
iter: 1760 mle_loss: 0.616 reward: 0.0000
iter: 1770 mle_loss: 0.435 reward: 0.0000
iter: 1780 mle_loss: 0.205 reward: 0.0000
iter: 1790 mle_loss: 0.426 reward: 0.0000
iter: 1800 mle_loss: 0.487 reward: 0.0000
iter: 1810 mle_loss: 0.755 reward: 0.0000
iter: 1820 mle_loss: 0.347 reward: 0.0000
iter: 1830 mle_loss: 0.450 reward: 0.0000
iter: 1840 mle_loss: 0.607 reward: 0.0000
iter: 1850 mle_loss: 0.267 reward: 0.0000
iter: 1860 mle_loss: 0.202 reward: 0.0000
iter: 1870 mle_loss: 0.359 reward: 0.0000
iter: 1880 mle_loss: 0.548 reward: 0.0000
iter: 1890 mle_loss: 0.407 reward: 0.0000
iter: 1900 mle_loss: 0.351 reward: 0.0000
iter: 1910 mle_loss: 0.248 reward: 0.0000
iter: 1920 mle_loss: 0.380 reward: 0.0000
iter: 1930 mle_loss: 0.302 reward: 0.0000
iter: 1940 mle_loss: 0.513 reward: 0.0000
iter: 1950 mle_loss: 0.151 reward: 0.0000
iter: 1960 mle_loss: 0.274 reward: 0.0000
iter: 1970 mle_loss: 0.357 reward: 0.0000
iter: 1980 mle_loss: 0.401 reward: 0.0000
iter: 1990 mle_loss: 0.215 reward: 0.0000
iter: 2000 mle_loss: 0.380 reward: 0.0000
iter: 2010 mle_loss: 0.281 reward: 0.0000
iter: 2020 mle_loss: 0.545 reward: 0.0000
iter: 2030 mle_loss: 0.252 reward: 0.0000
iter: 2040 mle_loss: 0.495 reward: 0.0000
iter: 2050 mle_loss: 0.225 reward: 0.0000
iter: 2060 mle_loss: 0.335 reward: 0.0000
iter: 2070 mle_loss: 0.362 reward: 0.0000
iter: 2080 mle_loss: 0.250 reward: 0.0000
iter: 2090 mle_loss: 0.263 reward: 0.0000
iter: 2100 mle_loss: 0.306 reward: 0.0000
iter: 2110 mle_loss: 0.217 reward: 0.0000
iter: 2120 mle_loss: 0.213 reward: 0.0000
iter: 2130 mle_loss: 0.307 reward: 0.0000
iter: 2140 mle_loss: 0.185 reward: 0.0000
iter: 2150 mle_loss: 0.204 reward: 0.0000
iter: 2160 mle_loss: 0.172 reward: 0.0000
iter: 2170 mle_loss: 0.148 reward: 0.0000
iter: 2180 mle_loss: 0.365 reward: 0.0000
iter: 2190 mle_loss: 0.179 reward: 0.0000
iter: 2200 mle_loss: 0.086 reward: 0.0000
iter: 2210 mle_loss: 0.137 reward: 0.0000
iter: 2220 mle_loss: 0.313 reward: 0.0000
iter: 2230 mle_loss: 0.232 reward: 0.0000
iter: 2240 mle_loss: 0.153 reward: 0.0000
iter: 2250 mle_loss: 0.264 reward: 0.0000
iter: 2260 mle_loss: 0.192 reward: 0.0000
iter: 2270 mle_loss: 0.124 reward: 0.0000
iter: 2280 mle_loss: 0.158 reward: 0.0000
iter: 2290 mle_loss: 0.234 reward: 0.0000
iter: 2300 mle_loss: 0.159 reward: 0.0000
iter: 2310 mle_loss: 0.118 reward: 0.0000
iter: 2320 mle_loss: 0.071 reward: 0.0000
iter: 2330 mle_loss: 0.158 reward: 0.0000
iter: 2340 mle_loss: 0.123 reward: 0.0000
iter: 2350 mle_loss: 0.162 reward: 0.0000
iter: 2360 mle_loss: 0.238 reward: 0.0000
iter: 2370 mle_loss: 0.057 reward: 0.0000
iter: 2380 mle_loss: 0.137 reward: 0.0000
iter: 2390 mle_loss: 0.122 reward: 0.0000
iter: 2400 mle_loss: 0.194 reward: 0.0000
iter: 2410 mle_loss: 0.094 reward: 0.0000
iter: 2420 mle_loss: 0.218 reward: 0.0000
iter: 2430 mle_loss: 0.156 reward: 0.0000
iter: 2440 mle_loss: 0.112 reward: 0.0000
iter: 2450 mle_loss: 0.193 reward: 0.0000
iter: 2460 mle_loss: 0.100 reward: 0.0000
iter: 2470 mle_loss: 0.161 reward: 0.0000
iter: 2480 mle_loss: 0.149 reward: 0.0000
iter: 2490 mle_loss: 0.096 reward: 0.0000
iter: 2500 mle_loss: 0.164 reward: 0.0000

------------------------------MLE Validation----------------------------

0000500.tar rouge_l: 0.2896
0001000.tar rouge_l: 0.3450           ### BEST MODEL
0001500.tar rouge_l: 0.2898
0002000.tar rouge_l: 0.2684
0002500.tar rouge_l: 0.2903

------------------------------MLE Testing----------------------------

0001000.tar scores: 
{'rouge-1': {'f': 0.3198728609234364, 'p': 0.40719348401816186, 'r': 0.2828704975863946}, 
'rouge-2': {'f': 0.18738412533800142, 'p': 0.24378047546954465, 'r': 0.16365593514992774}, 
'rouge-l': {'f': 0.3449876685273812, 'p': 0.5195584179761905, 'r': 0.27020822099624625}}

-----------------------------MLE+RL Training------------------------------

Training mle: yes, Training rl: yes, mle weight: 0.25, rl weight: 0.75
intra_encoder: True intra_decoder: True
Loaded model at data/saved_models/0001000.tar
iter: 1010 mle_loss: 0.850 reward: 0.6538
iter: 1020 mle_loss: 1.667 reward: 0.5006
iter: 1030 mle_loss: 1.717 reward: 0.4792
iter: 1040 mle_loss: 1.401 reward: 0.5444
iter: 1050 mle_loss: 0.842 reward: 0.6531
iter: 1060 mle_loss: 1.306 reward: 0.5639
iter: 1070 mle_loss: 1.741 reward: 0.4615
iter: 1080 mle_loss: 0.888 reward: 0.6692
iter: 1090 mle_loss: 1.368 reward: 0.5556
iter: 1100 mle_loss: 1.023 reward: 0.6020
iter: 1110 mle_loss: 1.782 reward: 0.4752
iter: 1120 mle_loss: 1.654 reward: 0.4671
iter: 1130 mle_loss: 0.962 reward: 0.6343
iter: 1140 mle_loss: 1.411 reward: 0.5311
iter: 1150 mle_loss: 0.809 reward: 0.6538
iter: 1160 mle_loss: 1.622 reward: 0.4965
iter: 1170 mle_loss: 0.965 reward: 0.6371
iter: 1180 mle_loss: 0.765 reward: 0.6616
iter: 1190 mle_loss: 1.481 reward: 0.5141
iter: 1200 mle_loss: 0.998 reward: 0.6346
iter: 1210 mle_loss: 1.467 reward: 0.5167
iter: 1220 mle_loss: 1.439 reward: 0.5061
iter: 1230 mle_loss: 1.490 reward: 0.5120
iter: 1240 mle_loss: 1.328 reward: 0.5279
iter: 1250 mle_loss: 0.569 reward: 0.7248
iter: 1260 mle_loss: 0.905 reward: 0.6271
iter: 1270 mle_loss: 1.633 reward: 0.4828
iter: 1280 mle_loss: 1.501 reward: 0.4798
iter: 1290 mle_loss: 0.456 reward: 0.7600
iter: 1300 mle_loss: 0.623 reward: 0.6991
iter: 1310 mle_loss: 0.962 reward: 0.6161
iter: 1320 mle_loss: 1.208 reward: 0.5504
iter: 1330 mle_loss: 1.640 reward: 0.4691
iter: 1340 mle_loss: 0.785 reward: 0.6751
iter: 1350 mle_loss: 0.663 reward: 0.6854
iter: 1360 mle_loss: 1.430 reward: 0.5216
iter: 1370 mle_loss: 0.953 reward: 0.6331
iter: 1380 mle_loss: 1.292 reward: 0.5306
iter: 1390 mle_loss: 1.409 reward: 0.5193
iter: 1400 mle_loss: 0.873 reward: 0.6548
iter: 1410 mle_loss: 0.635 reward: 0.6904
iter: 1420 mle_loss: 1.202 reward: 0.5550
iter: 1430 mle_loss: 1.291 reward: 0.5400
iter: 1440 mle_loss: 1.117 reward: 0.5886
iter: 1450 mle_loss: 1.061 reward: 0.5846
iter: 1460 mle_loss: 0.734 reward: 0.6624
iter: 1470 mle_loss: 0.956 reward: 0.6124
iter: 1480 mle_loss: 0.746 reward: 0.6641
iter: 1490 mle_loss: 1.082 reward: 0.5826
iter: 1500 mle_loss: 0.624 reward: 0.7173
iter: 1510 mle_loss: 1.642 reward: 0.4553
iter: 1520 mle_loss: 0.594 reward: 0.7201
iter: 1530 mle_loss: 1.434 reward: 0.5034
iter: 1540 mle_loss: 0.898 reward: 0.6242
iter: 1550 mle_loss: 0.739 reward: 0.6676
iter: 1560 mle_loss: 1.009 reward: 0.5787
iter: 1570 mle_loss: 1.330 reward: 0.5248 
iter: 1580 mle_loss: 0.812 reward: 0.6609
iter: 1590 mle_loss: 0.571 reward: 0.7112
iter: 1600 mle_loss: 1.253 reward: 0.5506
iter: 1610 mle_loss: 1.026 reward: 0.5699
iter: 1620 mle_loss: 0.997 reward: 0.6153
iter: 1630 mle_loss: 0.494 reward: 0.7241
iter: 1640 mle_loss: 0.939 reward: 0.6063
iter: 1650 mle_loss: 1.025 reward: 0.5846
iter: 1660 mle_loss: 1.300 reward: 0.5347
iter: 1670 mle_loss: 0.431 reward: 0.7633
iter: 1680 mle_loss: 0.895 reward: 0.6251
iter: 1690 mle_loss: 0.707 reward: 0.6713
iter: 1700 mle_loss: 0.735 reward: 0.6622
iter: 1710 mle_loss: 0.677 reward: 0.6737
iter: 1720 mle_loss: 1.251 reward: 0.5467
iter: 1730 mle_loss: 1.313 reward: 0.5185
iter: 1740 mle_loss: 0.713 reward: 0.6650
iter: 1750 mle_loss: 0.942 reward: 0.6130
iter: 1760 mle_loss: 0.601 reward: 0.7113
iter: 1770 mle_loss: 0.926 reward: 0.5936
iter: 1780 mle_loss: 1.188 reward: 0.5595
iter: 1790 mle_loss: 0.492 reward: 0.7287
iter: 1800 mle_loss: 0.783 reward: 0.6650
iter: 1810 mle_loss: 1.162 reward: 0.5589
iter: 1820 mle_loss: 0.736 reward: 0.6734
iter: 1830 mle_loss: 0.524 reward: 0.7151
iter: 1840 mle_loss: 0.848 reward: 0.6245
iter: 1850 mle_loss: 0.865 reward: 0.6334
iter: 1860 mle_loss: 0.787 reward: 0.6348
iter: 1870 mle_loss: 0.555 reward: 0.7045
iter: 1880 mle_loss: 0.834 reward: 0.6480
iter: 1890 mle_loss: 1.142 reward: 0.5572
iter: 1900 mle_loss: 1.180 reward: 0.5463
iter: 1910 mle_loss: 0.349 reward: 0.7817
iter: 1920 mle_loss: 0.702 reward: 0.6598 
iter: 1930 mle_loss: 1.057 reward: 0.5655
iter: 1940 mle_loss: 0.571 reward: 0.7072
iter: 1950 mle_loss: 0.794 reward: 0.6322
iter: 1960 mle_loss: 0.986 reward: 0.6111
iter: 1970 mle_loss: 0.521 reward: 0.7159
iter: 1980 mle_loss: 0.505 reward: 0.7111
iter: 1990 mle_loss: 0.698 reward: 0.6791
iter: 2000 mle_loss: 1.091 reward: 0.5705
iter: 2010 mle_loss: 0.880 reward: 0.6044
iter: 2020 mle_loss: 0.408 reward: 0.7474
iter: 2030 mle_loss: 0.845 reward: 0.6136
iter: 2040 mle_loss: 0.697 reward: 0.6795
iter: 2050 mle_loss: 1.078 reward: 0.5714
iter: 2060 mle_loss: 0.777 reward: 0.6469
iter: 2070 mle_loss: 0.376 reward: 0.7619
iter: 2080 mle_loss: 0.723 reward: 0.6499
iter: 2090 mle_loss: 0.959 reward: 0.5930
iter: 2100 mle_loss: 0.915 reward: 0.6036
iter: 2110 mle_loss: 1.123 reward: 0.5427
iter: 2120 mle_loss: 0.532 reward: 0.7217
iter: 2130 mle_loss: 0.622 reward: 0.6882
iter: 2140 mle_loss: 0.474 reward: 0.7291
iter: 2150 mle_loss: 0.549 reward: 0.7029
iter: 2160 mle_loss: 0.599 reward: 0.7075
iter: 2170 mle_loss: 0.780 reward: 0.6234
iter: 2180 mle_loss: 1.049 reward: 0.5811
iter: 2190 mle_loss: 0.671 reward: 0.6536
iter: 2200 mle_loss: 0.478 reward: 0.7278
iter: 2210 mle_loss: 1.106 reward: 0.5642
iter: 2220 mle_loss: 0.572 reward: 0.7161
iter: 2230 mle_loss: 0.770 reward: 0.6239
iter: 2240 mle_loss: 0.857 reward: 0.6251
iter: 2250 mle_loss: 0.866 reward: 0.6232
iter: 2260 mle_loss: 0.361 reward: 0.7706
iter: 2270 mle_loss: 0.636 reward: 0.6873
iter: 2280 mle_loss: 0.969 reward: 0.5774
iter: 2290 mle_loss: 0.840 reward: 0.6081
iter: 2300 mle_loss: 0.265 reward: 0.7993
iter: 2310 mle_loss: 0.618 reward: 0.6904
iter: 2320 mle_loss: 0.694 reward: 0.6690
iter: 2330 mle_loss: 0.716 reward: 0.6585
iter: 2340 mle_loss: 0.494 reward: 0.7197
iter: 2350 mle_loss: 0.554 reward: 0.6988
iter: 2360 mle_loss: 0.508 reward: 0.6990
iter: 2370 mle_loss: 0.636 reward: 0.6587
iter: 2380 mle_loss: 1.057 reward: 0.5643
iter: 2390 mle_loss: 0.589 reward: 0.7031
iter: 2400 mle_loss: 0.528 reward: 0.7253
iter: 2410 mle_loss: 0.922 reward: 0.6026
iter: 2420 mle_loss: 0.607 reward: 0.6669
iter: 2430 mle_loss: 0.398 reward: 0.7412
iter: 2440 mle_loss: 0.659 reward: 0.6400
iter: 2450 mle_loss: 0.600 reward: 0.6987
iter: 2460 mle_loss: 0.384 reward: 0.7523
iter: 2470 mle_loss: 0.714 reward: 0.6656
iter: 2480 mle_loss: 0.527 reward: 0.7081
iter: 2490 mle_loss: 0.559 reward: 0.6890
iter: 2500 mle_loss: 0.711 reward: 0.6583
iter: 2510 mle_loss: 0.552 reward: 0.7069
iter: 2520 mle_loss: 0.882 reward: 0.6098
iter: 2530 mle_loss: 0.674 reward: 0.6736
iter: 2540 mle_loss: 0.569 reward: 0.6901
iter: 2550 mle_loss: 0.468 reward: 0.7421
iter: 2560 mle_loss: 0.654 reward: 0.6454 
iter: 2570 mle_loss: 0.721 reward: 0.6300
iter: 2580 mle_loss: 0.297 reward: 0.8072
iter: 2590 mle_loss: 0.402 reward: 0.7392
iter: 2600 mle_loss: 0.903 reward: 0.5930
iter: 2610 mle_loss: 0.844 reward: 0.6229
iter: 2620 mle_loss: 0.631 reward: 0.6400
iter: 2630 mle_loss: 0.573 reward: 0.7026
iter: 2640 mle_loss: 0.284 reward: 0.7817
iter: 2650 mle_loss: 0.675 reward: 0.6682
iter: 2660 mle_loss: 0.711 reward: 0.6213
iter: 2670 mle_loss: 0.659 reward: 0.6707
iter: 2680 mle_loss: 0.267 reward: 0.7952
iter: 2690 mle_loss: 0.604 reward: 0.6844
iter: 2700 mle_loss: 0.666 reward: 0.6329
iter: 2710 mle_loss: 0.714 reward: 0.6314
iter: 2720 mle_loss: 0.208 reward: 0.8256
iter: 2730 mle_loss: 0.455 reward: 0.7172
iter: 2740 mle_loss: 0.524 reward: 0.6797
iter: 2750 mle_loss: 0.707 reward: 0.6683
iter: 2760 mle_loss: 0.500 reward: 0.7052
iter: 2770 mle_loss: 0.493 reward: 0.7303
iter: 2780 mle_loss: 0.269 reward: 0.8091
iter: 2790 mle_loss: 0.397 reward: 0.7371
iter: 2800 mle_loss: 0.523 reward: 0.6918
iter: 2810 mle_loss: 0.856 reward: 0.6034
iter: 2820 mle_loss: 0.448 reward: 0.7442
iter: 2830 mle_loss: 0.569 reward: 0.6690
iter: 2840 mle_loss: 0.751 reward: 0.6350
iter: 2850 mle_loss: 0.296 reward: 0.7702
iter: 2860 mle_loss: 0.254 reward: 0.7953
iter: 2870 mle_loss: 0.477 reward: 0.7311
iter: 2880 mle_loss: 0.702 reward: 0.6564
iter: 2890 mle_loss: 0.597 reward: 0.6655
iter: 2900 mle_loss: 0.493 reward: 0.6834
iter: 2910 mle_loss: 0.363 reward: 0.7437 
iter: 2920 mle_loss: 0.549 reward: 0.6867
iter: 2930 mle_loss: 0.359 reward: 0.7743
iter: 2940 mle_loss: 0.857 reward: 0.5967
iter: 2950 mle_loss: 0.179 reward: 0.8347
iter: 2960 mle_loss: 0.428 reward: 0.7204
iter: 2970 mle_loss: 0.526 reward: 0.6889
iter: 2980 mle_loss: 0.664 reward: 0.6566
iter: 2990 mle_loss: 0.295 reward: 0.7740
iter: 3000 mle_loss: 0.533 reward: 0.6745

----------------------------------MLE+RL Validation--------------------------------------

0001500.tar rouge_l: 0.3125          ##Best Model
0002000.tar rouge_l: 0.2956
0002500.tar rouge_l: 0.3029
0003000.tar rouge_l: 0.2769

----------------------------------MLE+RL Testing--------------------------------------
0001500.tar scores: 
{'rouge-1': {'f': 0.30394816372035105, 'p': 0.38923155673042714, 'r': 0.2669144746884053}, 
'rouge-2': {'f': 0.17695009059376737, 'p': 0.23290476075407537, 'r': 0.15331403457211143}, 
'rouge-l': {'f': 0.31247062769929973, 'p': 0.45185872431258434, 'r': 0.2496851899023605}}

----------------------------------RL Training--------------------------------------

Training mle: no, Training rl: yes, mle weight: 0.00, rl weight: 1.00
intra_encoder: True intra_decoder: True
Loaded model at data/saved_models/0002500.tar
iter: 2510 mle_loss: 0.000 reward: 0.7708
iter: 2520 mle_loss: 0.000 reward: 0.6518
iter: 2530 mle_loss: 0.000 reward: 0.5995
iter: 2540 mle_loss: 0.000 reward: 0.6609
iter: 2550 mle_loss: 0.000 reward: 0.7344
iter: 2560 mle_loss: 0.000 reward: 0.6640
iter: 2570 mle_loss: 0.000 reward: 0.5912
iter: 2580 mle_loss: 0.000 reward: 0.7388
iter: 2590 mle_loss: 0.000 reward: 0.6476
iter: 2600 mle_loss: 0.000 reward: 0.6915
iter: 2610 mle_loss: 0.000 reward: 0.5667
iter: 2620 mle_loss: 0.000 reward: 0.5836
iter: 2630 mle_loss: 0.000 reward: 0.7055
iter: 2640 mle_loss: 0.000 reward: 0.6221
iter: 2650 mle_loss: 0.000 reward: 0.7281
iter: 2660 mle_loss: 0.000 reward: 0.5758
iter: 2670 mle_loss: 0.000 reward: 0.6993
iter: 2680 mle_loss: 0.000 reward: 0.7251
iter: 2690 mle_loss: 0.000 reward: 0.6064
iter: 2700 mle_loss: 0.000 reward: 0.6922
iter: 2710 mle_loss: 0.000 reward: 0.5906
iter: 2720 mle_loss: 0.000 reward: 0.5992
iter: 2730 mle_loss: 0.000 reward: 0.5890
iter: 2740 mle_loss: 0.000 reward: 0.6070
iter: 2750 mle_loss: 0.000 reward: 0.7697
iter: 2760 mle_loss: 0.000 reward: 0.6884
iter: 2770 mle_loss: 0.000 reward: 0.5591
iter: 2780 mle_loss: 0.000 reward: 0.5758
iter: 2790 mle_loss: 0.000 reward: 0.7965
iter: 2800 mle_loss: 0.000 reward: 0.7400
iter: 2810 mle_loss: 0.000 reward: 0.6681
iter: 2820 mle_loss: 0.000 reward: 0.6294
iter: 2830 mle_loss: 0.000 reward: 0.5473
iter: 2840 mle_loss: 0.000 reward: 0.7269
iter: 2850 mle_loss: 0.000 reward: 0.7365
iter: 2860 mle_loss: 0.000 reward: 0.5885
iter: 2870 mle_loss: 0.000 reward: 0.6846
iter: 2880 mle_loss: 0.000 reward: 0.6076
iter: 2890 mle_loss: 0.000 reward: 0.5849
iter: 2900 mle_loss: 0.000 reward: 0.6962
iter: 2910 mle_loss: 0.000 reward: 0.7289
iter: 2920 mle_loss: 0.000 reward: 0.6116
iter: 2930 mle_loss: 0.000 reward: 0.5932
iter: 2940 mle_loss: 0.000 reward: 0.6332
iter: 2950 mle_loss: 0.000 reward: 0.6417
iter: 2960 mle_loss: 0.000 reward: 0.7148
iter: 2970 mle_loss: 0.000 reward: 0.6654
iter: 2980 mle_loss: 0.000 reward: 0.7108
iter: 2990 mle_loss: 0.000 reward: 0.6352
iter: 3000 mle_loss: 0.000 reward: 0.7487
iter: 3010 mle_loss: 0.000 reward: 0.5263
iter: 3020 mle_loss: 0.000 reward: 0.7440
iter: 3030 mle_loss: 0.000 reward: 0.5674
iter: 3040 mle_loss: 0.000 reward: 0.6768
iter: 3050 mle_loss: 0.000 reward: 0.6969
iter: 3060 mle_loss: 0.000 reward: 0.6359
iter: 3070 mle_loss: 0.000 reward: 0.5887
iter: 3080 mle_loss: 0.000 reward: 0.6950
iter: 3090 mle_loss: 0.000 reward: 0.7420
iter: 3100 mle_loss: 0.000 reward: 0.6023
iter: 3110 mle_loss: 0.000 reward: 0.6294
iter: 3120 mle_loss: 0.000 reward: 0.6539
iter: 3130 mle_loss: 0.000 reward: 0.7640
iter: 3140 mle_loss: 0.000 reward: 0.6521
iter: 3150 mle_loss: 0.000 reward: 0.6370
iter: 3160 mle_loss: 0.000 reward: 0.5831
iter: 3170 mle_loss: 0.000 reward: 0.7884
iter: 3180 mle_loss: 0.000 reward: 0.6601
iter: 3190 mle_loss: 0.000 reward: 0.7020
iter: 3200 mle_loss: 0.000 reward: 0.6972
iter: 3210 mle_loss: 0.000 reward: 0.7041
iter: 3220 mle_loss: 0.000 reward: 0.5958
iter: 3230 mle_loss: 0.000 reward: 0.5686
iter: 3240 mle_loss: 0.000 reward: 0.7044
iter: 3250 mle_loss: 0.000 reward: 0.6377
iter: 3260 mle_loss: 0.000 reward: 0.7301
iter: 3270 mle_loss: 0.000 reward: 0.6307
iter: 3280 mle_loss: 0.000 reward: 0.5997
iter: 3290 mle_loss: 0.000 reward: 0.7481
iter: 3300 mle_loss: 0.000 reward: 0.6829
iter: 3310 mle_loss: 0.000 reward: 0.5908
iter: 3320 mle_loss: 0.000 reward: 0.6796
iter: 3330 mle_loss: 0.000 reward: 0.7245
iter: 3340 mle_loss: 0.000 reward: 0.6512
iter: 3350 mle_loss: 0.000 reward: 0.6457
iter: 3360 mle_loss: 0.000 reward: 0.6662
iter: 3370 mle_loss: 0.000 reward: 0.7290
iter: 3380 mle_loss: 0.000 reward: 0.6661
iter: 3390 mle_loss: 0.000 reward: 0.6008
iter: 3400 mle_loss: 0.000 reward: 0.5749
iter: 3410 mle_loss: 0.000 reward: 0.7888
iter: 3420 mle_loss: 0.000 reward: 0.6758
iter: 3430 mle_loss: 0.000 reward: 0.5925
iter: 3440 mle_loss: 0.000 reward: 0.7281
iter: 3450 mle_loss: 0.000 reward: 0.6580
iter: 3460 mle_loss: 0.000 reward: 0.6497
iter: 3470 mle_loss: 0.000 reward: 0.7357
iter: 3480 mle_loss: 0.000 reward: 0.7273
iter: 3490 mle_loss: 0.000 reward: 0.6895
iter: 3500 mle_loss: 0.000 reward: 0.5989
iter: 3510 mle_loss: 0.000 reward: 0.6249
iter: 3520 mle_loss: 0.000 reward: 0.7525
iter: 3530 mle_loss: 0.000 reward: 0.6277
iter: 3540 mle_loss: 0.000 reward: 0.6906
iter: 3550 mle_loss: 0.000 reward: 0.5997
iter: 3560 mle_loss: 0.000 reward: 0.6535
iter: 3570 mle_loss: 0.000 reward: 0.7670
iter: 3580 mle_loss: 0.000 reward: 0.6571
iter: 3590 mle_loss: 0.000 reward: 0.6196
iter: 3600 mle_loss: 0.000 reward: 0.6218
iter: 3610 mle_loss: 0.000 reward: 0.5564
iter: 3620 mle_loss: 0.000 reward: 0.7270
iter: 3630 mle_loss: 0.000 reward: 0.6992
iter: 3640 mle_loss: 0.000 reward: 0.7304
iter: 3650 mle_loss: 0.000 reward: 0.7036
iter: 3660 mle_loss: 0.000 reward: 0.7048
iter: 3670 mle_loss: 0.000 reward: 0.6280
iter: 3680 mle_loss: 0.000 reward: 0.5978
iter: 3690 mle_loss: 0.000 reward: 0.6582
iter: 3700 mle_loss: 0.000 reward: 0.7110
iter: 3710 mle_loss: 0.000 reward: 0.5785
iter: 3720 mle_loss: 0.000 reward: 0.7035
iter: 3730 mle_loss: 0.000 reward: 0.6238
iter: 3740 mle_loss: 0.000 reward: 0.6237
iter: 3750 mle_loss: 0.000 reward: 0.6158
iter: 3760 mle_loss: 0.000 reward: 0.7641
iter: 3770 mle_loss: 0.000 reward: 0.6705
iter: 3780 mle_loss: 0.000 reward: 0.5738
iter: 3790 mle_loss: 0.000 reward: 0.5932
iter: 3800 mle_loss: 0.000 reward: 0.7939
iter: 3810 mle_loss: 0.000 reward: 0.6811
iter: 3820 mle_loss: 0.000 reward: 0.6742
iter: 3830 mle_loss: 0.000 reward: 0.6474
iter: 3840 mle_loss: 0.000 reward: 0.7160
iter: 3850 mle_loss: 0.000 reward: 0.6901
iter: 3860 mle_loss: 0.000 reward: 0.6941
iter: 3870 mle_loss: 0.000 reward: 0.6477
iter: 3880 mle_loss: 0.000 reward: 0.5659
iter: 3890 mle_loss: 0.000 reward: 0.6882
iter: 3900 mle_loss: 0.000 reward: 0.7028
iter: 3910 mle_loss: 0.000 reward: 0.6027
iter: 3920 mle_loss: 0.000 reward: 0.6550
iter: 3930 mle_loss: 0.000 reward: 0.7312
iter: 3940 mle_loss: 0.000 reward: 0.6237
iter: 3950 mle_loss: 0.000 reward: 0.6794
iter: 3960 mle_loss: 0.000 reward: 0.7351
iter: 3970 mle_loss: 0.000 reward: 0.6594
iter: 3980 mle_loss: 0.000 reward: 0.7031
iter: 3990 mle_loss: 0.000 reward: 0.6603
iter: 4000 mle_loss: 0.000 reward: 0.6411

------------------------------------RL Validation--------------------------------------------

0003000.tar rouge_l: 0.3340
0003500.tar rouge_l: 0.3421	###Best Model
0004000.tar rouge_l: 0.3176

----------------------------------RL Testing--------------------------------------------------

0003500.tar scores: 
{'rouge-1': {'f': 0.3173991113843275, 'p': 0.41245745240064535, 'r': 0.27614900215772026}, 
'rouge-2': {'f': 0.18852843587777787, 'p': 0.25046859555012757, 'r': 0.1622990297381499}, 
'rouge-l': {'f': 0.34214496333785943, 'p': 0.5147891204773996, 'r': 0.2667430801426903}}

